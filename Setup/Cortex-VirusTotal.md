# <img align="center" src="https://www.virustotal.com/gui/images/manifest/icon-144x144.png" height="45px" width="45px">&nbsp; Cortext Analyzer (VirusTotal)
VirusTotal stands as one of the foremost global search engines for threat intelligence, offering comprehensive insights into potentially malicious files, domains, URLs, and IPs. 
Leveraging an extensive database and an array of advanced scanning technologies, VirusTotal meticulously analyzes digital artifacts to detect any indicators of compromise or suspicious behavior. 
This platform serves as a valuable resource for cybersecurity professionals and researchers, providing in-depth reports and actionable intelligence to bolster proactive threat mitigation efforts. 
With its robust API, users can seamlessly access and leverage the wealth of information generated by VirusTotal, empowering them to enhance their security posture and stay ahead of emerging threats.
<br><br>

## VirusTotal API 
VirusTotal provides a REST API which enabled us to query the SaerchEngine of VirusTotal remotely with ease. Before we can setup up our VirusTotal Cortex Analyzer, we will need to register for a API key 
to use in order to connect with the VirusTotal from our Cortex Host. These API keys will only be issued when you create an account with VirusTotal which has no cost required, though they do have a paid 
version which unlocks further functionality. If you don't already have an account with VirusTotal, head over to [virustotal.com](https://www.virustotal.com/gui/join-us) to signup. 
<br><br>
Once you have an account and have signed into VisusTotal, head over to your to top right hand side of your window and click on your profile pick. From the menu listed click on ***API Key*** which we redirect you 
to your accounts API page. Here listed will be your free version of VirusTotal's ***API Key*** which can be used to query is various API nodes, which you can find more information on [Here](https://docs.virustotal.com/reference/overview)

<br>

## Analyzer Setup 
1. Log into your Cortex account and navigate to ***Organisation*** > ***Analyzers***.
2. In your Analyzer page use the search bar to search up ***VirusTotal*** to find the ***VirusTotal_GetReport_3_1*** Analyzer
3. Enable the Analyzer by clicking the ***+ Enable*** and enter in the following configurations:
    - **Key:** <VIRUSTOTAL_APIKEY>
  The remaining configs can be left as default and click ***Save***
4. With our VirusTotal Analyzer now enabled, moving over to the ***Anazlyer*** Tab on the top nav bar we should now see our ***VirusTotal_GetReport_3_1*** listed
5. To ensure that our Analyzer is working we can do a test run by click the ***Run*** button and set the following Configurations:
    - **Data Type:** Hash
    - **Data:** a2534f954854e317c575b2b6009219c1f08994d1d5550e638acfa48f188da4ab
    - **Analyzers:** VirusTotal_GetReport_3_1
  Click on ***Start*** to run analyzer
6. Over on your ***Job History*** page you should now see a new job pending and once complete should show ***Success***
7. Click on ***View*** to open up the results from the Analyzer that VirusTotal has returned

